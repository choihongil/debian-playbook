---

- name: Tap repositories
  homebrew_tap:
    name: "{{ item }}"
    state: present
  with_items:
    - koekeishiya/formulae
    - homebrew/cask-fonts

- name: Install packages
  homebrew:
    name: ['ansible', 'jq', 'skhd', 'yabai']
    state: present

- name: Install cask packages
  homebrew_cask:
    name: "{{ item }}"
    state: present
    accept_external_apps: true
  with_items:
    - alacritty
    - alfred
    - dbeaver-community
    - firefox
    - font-cica
    - font-fontawesome
    - google-chrome
    - google-japanese-ime
    - insomnia
    - java
    - joplin
    - karabiner-elements
    - ubersicht
    - vagrant
    - virtualbox

# - name: Allow 'sudo' group to have passwordless sudo
#   lineinfile:
#     path: /etc/sudoers
#     state: present
#     regexp: '^%admin'
#     line: '%admin		ALL = (ALL) NOPASSWD: ALL'
#     validate: '/usr/sbin/visudo -cf %s'
#   become: yes

- name: Ensure vm_share directory present
  file:
    path: "{{ ansible_user_dir }}/vm_share"
    state: directory
    mode: 0755

- name: yabairc
  copy:
    src: yabairc
    dest: "{{ ansible_user_dir }}/.yabairc"

- name: skhdrc
  copy:
    src: skhdrc
    dest: "{{ ansible_user_dir }}/.skhdrc"

- name: Übersicht widgets
  copy:
    src: Übersicht
    dest: "{{ ansible_user_dir }}/Library/Application\ Support/"
    mode: preserve
